---
title: 'GEE ACOLITE: A python library to connect Google Earth Engine with ACOLITE'
tags:
  - Python
  - remote sensing
  - atmospheric correction
  - Google Earth Engine
  - Sentinel-2
  - water quality
  - aquatic remote sensing
  - ACOLITE
authors:
  - name: Sergio Heredia
    orcid: 0009-0003-9495-9625
    corresponding: true
    affiliation: 1
  - name: Isabel Caballero
    orcid: 0000-0001-7485-0989
    corresponding: false
    affiliation: 1
affiliations:
 - name: Department of Ecology and Coastal Management, Institute of Marine Sciences of Andalusia (ICMAN), Spanish National Research Council (CSIC), 11519 Puerto Real, Spain  
   index: 1
date: 15 December 2025
bibliography: paper.bib
---

# Summary

Atmospheric correction is a critical preprocessing step in aquatic remote sensing, required to retrieve accurate water-leaving reflectance from satellite imagery. The ACOLITE (Atmospheric Correction for OLI 'lite') software [@vanhellemont2019; @vanhellemont2021] has become a widely-used tool for atmospheric correction of aquatic imagery, particularly for its dark spectrum fitting (DSF) algorithm. However, ACOLITE operates on downloaded scenes, limiting its scalability for large-scale or time-series analyses.

Google Earth Engine (GEE) is a cloud-based platform that provides access to petabytes of satellite imagery and enables planetary-scale geospatial analisis (Gorelick et al., 2017) . While GEE offers built-in atmospheric correction products for Sentinel-2 (Level-2A), these are optimized for terrestrial applications and often underperform in coastal and inland water environments where adjacency effects and complex atmospheric conditions are prevalent.

`GEE ACOLITE` bridges this gap by implementing ACOLITE's dark spectrum fitting atmospheric correction algorithm directly within the Google Earth Engine framework, enabling efficient, scalable atmospheric correction for aquatic applications.

# Statement of need

Researchers studying coastal and inland waters require accurate atmospheric correction to derive water quality parameters. Current workflows involve manually downloading scenes, processing with ACOLITE, managing large intermediate files, and combining results, that is time-consuming and challenging to scale. While GEE provides Level-2A products via Sen2Cor [@louis2016], these are optimized for land applications and may not adequately account for adjacency effects, sun glint, and other factors critical for aquatic remote sensing [@warren2019].

`GEE ACOLITE` addresses these limitations by:

- **Implementing DSF correction in GEE**: Enabling ACOLITE's dark spectrum fitting algorithm within GEE's cloud infrastructure 
- **Eliminating data download requirements**: Processing occurs entirely within GEE, accessing imagery directly from the archive
- **Enabling scalable analysis**: Users can process entire image collections across large spatial and temporal extents
- **Providing water quality products**: Direct computation of SPM, turbidity, chlorophyll-a, and bathymetric maps
- **Supporting batch processing**: Efficient processing of multiple images with consistent settings

The library is designed for aquatic remote sensing researchers, environmental monitoring agencies, and coastal zone managers who require accurate atmospheric correction for water quality assessment and monitoring.

# Implementation

`GEE ACOLITE` is implemented in Python and interfaces with both the Earth Engine Python API [@earthengine] and the ACOLITE software package. The core atmospheric correction workflow includes:

1. **Dark spectrum extraction**: Three methods (darkest pixel, percentile, and intercept) for identifying dark water pixels
2. **Aerosol optical thickness (AOT) estimation**: Using lookup tables (LUTs) generated by ACOLITE
3. **Atmospheric correction**: Retrieving water-leaving reflectance using radiative transfer calculations
4. **Sun glint correction**: Optional sun glint corrections
5. **Water quality products**: Computation of derived products (SPM, chlorophyll-a, turbidity, bathymetry)

The library maintains compatibility with ACOLITE's configuration system while adapting the algorithms for GEE's distributed computing environment. Processing can be configured through Python dictionaries or ACOLITE-compatible settings files.

# Features

Key features of `GEE ACOLITE` include:

- **Multiple dark spectrum methods**: Darkest pixel, percentile-based, and linear regression intercept approaches
- **Flexible model selection**: Three criteria for optimal atmospheric model selection
- **Water quality parameters**: Built-in algorithms for SPM [@nechad2010], turbidity, chlorophyll-a [@oreilly1998; @oreilly2000], and bathymetry
- **Cloud masking**: Integration with Sentinel-2 Cloud Probability
- **Batch processing**: Efficient processing of image collections

# Validation and Performance

The library has been validated against standalone ACOLITE processing for Sentinel-2 imagery. \autoref{fig:spectral_comparison} compares mean remote sensing reflectance (Rrs) spectra from eight scenes over Ria Formosa using three atmospheric correction approaches: (1) GEE's Sen2Cor L2A, (2) standalone ACOLITE (Local ACOLITE-Fixed), and (3) GEE ACOLITE.

The results demonstrate similar spectral responses across all tested scenes, with GEE ACOLITE retrievals closely matching the standalone ACOLITE processing. Both ACOLITE implementations show consistent retrieval of Rrs across the visible and near-infrared spectrum, with typical values ranging from 0.005 to 0.020 sr−1. The agreement between GEE ACOLITE and local ACOLITE processing validates the correct implementation of the DSF algorithm within the GEE framework. Minor differences between Sen2Cor and ACOLITE-based retrievals are expected due to fundamental differences in atmospheric correction approaches, with ACOLITE’s DSF method being specifically optimized for aquatic applications

![Comparison of mean remote sensing reflectance (Rrs) spectra from eight Sentinel-2 scenes over the Ria Formosa (Portugal) using three atmospheric correction methods: GEE Sen2Cor L2A, Local ACOLITE-Fixed, and GEE + ACOLITE-Fixed.\label{fig:spectral_comparison}](figs/spectral_comparison.png)

Beyond spectral validation, \autoref{fig:sdb} demonstrates the application of GEE ACOLITE-corrected imagery for satellite-derived bathymetry (SDB) using Stumpf's ratio method [@stumpf2003]. The results show that water quality products derived from GEE ACOLITE are suitable for subsequent environmental applications.

![Satellite-derived bathymetry (SDB) from Sentinel-2 imagery (2018-10-07) over Ria Formosa using Stumpf's green band ratio method [@stumpf2003] applied to three atmospheric correction methods. Each row corresponds to a different method: Local ACOLITE-Fixed (a), GEE + ACOLITE-Fixed (b), and GEE Sen2Cor (c). Columns show: (a.1, a.2, a.3) calibration scatter plots between pseudo-SDB and in situ depth measurements, (a.2, b.2, c.2) validation density scatter plots comparing SDB retrievals with in situ depth, and (a.3, b.3, c.3) residual histograms with validation metrics (MedAE, absolute standard deviation, and MSD). Both GEE-based methods were masked using Local ACOLITE masks to ensure fair comparison over the same water pixels.\label{fig:sdb}](figs/sdb.png)

# Availability

The source code for `GEE ACOLITE` is available on GitHub at https://github.com/Aouei/gee_acolite under the GNU General Public License v3.0. Documentation, examples, and API reference are included in the repository. The library requires ACOLITE source code from https://github.com/acolite/acolite.

# Acknowledgements

This library is based on an initial attempt by Dr. Vanhellemont to connect ACOLITE with Google Earth Engine, which served as inspiration and foundation for the current implementation. We acknowledge the Google Earth Engine team for providing the cloud computing platform.

# Funding
This work has been financially supported by the Grant CNS2023-143630 funded by MICIU/AEI/10.13039/501100011033 and by European Union Next Generation EU/PRTR. 

# References