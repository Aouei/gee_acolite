---
title: 'GEE ACOLITE: Atmospheric Correction for Google Earth Engine'
tags:
  - Python
  - remote sensing
  - atmospheric correction
  - Google Earth Engine
  - Sentinel-2
  - water quality
  - aquatic remote sensing
  - ACOLITE
authors:
  - name: Sergio Heredia
    orcid: 0009-0003-9495-9625
    corresponding: true
    affiliation: 1
  - name: Isabel Caballero
    orcid: 0000-0001-7485-0989
    corresponding: false
    affiliation: 1
affiliations:
 - name: Department of Ecology and Coastal Management, Institute of Marine Sciences Andalusia (ICMAN-CSIC), Spanish National Research Council (CSIC), 11519 Puerto Real, Spain
   index: 1
date: 15 December 2025
bibliography: paper.bib
---

# Summary

Atmospheric correction is a critical preprocessing step in aquatic remote sensing, required to retrieve accurate water-leaving reflectance from satellite imagery. The ACOLITE (Atmospheric Correction for OLI 'lite') software [@vanhellemont2019; @vanhellemont2021] has become a widely-used tool for atmospheric correction of aquatic imagery, particularly for its dark spectrum fitting (DSF) algorithm. However, ACOLITE operates on individual downloaded scenes, limiting its scalability for large-scale or time-series analyses.

Google Earth Engine (GEE) [@gorelick2017] is a cloud-based platform that provides access to petabytes of satellite imagery and enables planetary-scale geospatial analysis. While GEE offers built-in atmospheric correction products for Sentinel-2 (Level-2A), these are optimized for terrestrial applications and often underperform in coastal and inland water environments where adjacency effects and complex atmospheric conditions are prevalent.

`GEE ACOLITE` bridges this gap by implementing ACOLITE's dark spectrum fitting atmospheric correction algorithm directly within the Google Earth Engine framework, enabling efficient, scalable atmospheric correction for aquatic applications.

# Statement of need

Researchers studying coastal and inland waters require accurate atmospheric correction to derive water quality parameters such as suspended particulate matter (SPM), chlorophyll-a concentration, and turbidity. Current workflows typically involve:

1. Manually downloading Sentinel-2 Level-1C scenes
2. Processing each scene individually with ACOLITE
3. Managing large volumes of intermediate files
4. Combining results for spatial or temporal analysis

This approach is time-consuming, storage-intensive, and challenging to scale for regional or global studies. While GEE provides Level-2A surface reflectance products, these are generated using the Sen2Cor algorithm [@louis2016], which is designed for land applications and may not adequately account for adjacency effects, sun glint, and other factors critical for accurate aquatic remote sensing [@warren2019].

`GEE ACOLITE` addresses these limitations by:

- **Implementing DSF correction in GEE**: Enabling ACOLITE's proven dark spectrum fitting algorithm within GEE's cloud infrastructure
- **Eliminating data download requirements**: Processing occurs entirely within GEE, accessing imagery directly from the archive
- **Enabling scalable analysis**: Users can process entire image collections across large spatial and temporal extents
- **Providing water quality products**: Direct computation of SPM, turbidity, chlorophyll-a, and bathymetric indices
- **Supporting batch processing**: Efficient processing of multiple images with consistent settings

The package is designed for aquatic remote sensing researchers, environmental monitoring agencies, and coastal zone managers who require accurate atmospheric correction for water quality assessment and monitoring.

# Implementation

`GEE ACOLITE` is implemented in Python and interfaces with both the Earth Engine Python API [@earthengine] and the ACOLITE software package. The core atmospheric correction workflow includes:

1. **Dark spectrum extraction**: Three methods (darkest pixel, percentile, and intercept) for identifying dark water pixels
2. **Aerosol optical thickness (AOT) estimation**: Using lookup tables (LUTs) generated by ACOLITE
3. **Atmospheric correction**: Retrieving water-leaving reflectance using radiative transfer calculations
4. **Residual correction**: Optional sun glint and adjacency effect corrections
5. **Water quality products**: Computation of derived products (SPM, chlorophyll, turbidity, bathymetry)

The package maintains compatibility with ACOLITE's configuration system while adapting the algorithms for GEE's distributed computing environment. Processing can be configured through Python dictionaries or ACOLITE-compatible settings files.

# Features

Key features of `GEE ACOLITE` include:

- **Multiple dark spectrum methods**: Darkest pixel, percentile-based, and linear regression intercept approaches
- **Flexible model selection**: Three criteria for selecting optimal atmospheric model (minimum RMSD, minimum delta-tau, coefficient of variation)
- **Water quality parameters**: Built-in algorithms for SPM [@nechad2010], turbidity, chlorophyll-a [@oreilly1998; @oreilly2000], and pseudo-satellite derived bathymetry
- **Cloud masking**: Integration with Sentinel-2 Cloud Probability dataset [@sentinelhub]
- **Batch processing**: Efficient processing of image collections
- **Configurable processing**: Comprehensive settings for atmospheric parameters, correction methods, and output products

# Example usage

```python
import ee
import acolite as ac
from gee_acolite import ACOLITE

ee.Initialize()

# Define area and time range
roi = ee.Geometry.Point([-76.7, 38.2])
images = ee.ImageCollection('COPERNICUS/S2_HARMONIZED') \
    .filterBounds(roi) \
    .filterDate('2023-06-01', '2023-06-30')

# Configure processing
settings = {
    'aerosol_correction': 'dark_spectrum',
    'dsf_aot_estimate': 'fixed',
    'dsf_model_selection': 'min_drmsd',
    'l2w_parameters': ['spm_nechad2016', 'chl_oc2']
}

# Apply correction
processor = ACOLITE(ac, settings)
corrected_images, _ = processor.correct(images)
```

# Validation and Performance

The package has been validated against standalone ACOLITE processing for Sentinel-2 imagery in various aquatic environments. Results show consistent retrieval of water-leaving reflectance and derived water quality parameters. Processing within GEE eliminates download time and storage requirements while maintaining accuracy comparable to traditional workflows.

# Availability

The source code for `GEE ACOLITE` is available on GitHub at https://github.com/Aouei/gee_acolite under the GNU General Public License v3.0. Documentation, examples, and API reference are included in the repository. The package requires ACOLITE to be installed separately from https://github.com/acolite/acolite.

# Acknowledgements

This package builds upon the ACOLITE software developed by Dr. Quinten Vanhellemont and colleagues at the Royal Belgian Institute of Natural Sciences (RBINS). We acknowledge the Google Earth Engine team for providing the cloud computing platform.

# References